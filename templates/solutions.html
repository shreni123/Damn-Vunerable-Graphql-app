{% extends 'partials/base.html' %}

{% block header %}
  {% include 'partials/base_header.html' %}
{% endblock %}

{% block content %}
  <!-- Page Content -->
  <div id="page-content-wrapper">
    {% include 'partials/navbar.html' %}
    <div class="container-fluid">
      <h1 class="mt-4">Challenge Solutions</h1>
      <hr />
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header"><b>Solutions</b></div>
            <div class="card-body">
              <div id="toc_container">
                <p class="toc_title">Table of Contents</p>
                  <ul class="toc_list">
                    <li>
                      <b>Denial of Service</b>
                      <ul>
                        <li>
                          <a href="#dos-batch">Batch Query Attack</a>
                        </li>
                        <li>
                          <a href="#dos-recursion">Deep Recursion Query Attack</a>
                        </li>
                        <li>
                          <a href="#dos-intensive">Resource Intensive Query Attack</a>
                        </li>
                        <li>
                          <a href="#dos-fielddup">Field Duplication Attack</a>
                        </li>
                        <li>
                          <a href="#dos-aliases">Aliases based Attack</a>
                        </li>
                      </ul>
                    </li>

                    <li>
                      <b>Information Disclosure</b>
                      <ul>
                        <li>
                          <a href="#info-introspection">GraphQL Introspection</a>
                        </li>
                        <li>
                          <a href="#info-igql">GraphQL Interface</a>
                        </li>
                        <li>
                          <a href="#info-suggestions">GraphQL Field Suggestions</a>
                        </li>
                        <li>
                          <a href="#info-ssrf">Server Side Request Forgery</a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <b>Code Execution</b>
                      <ul>
                        <li>
                          <a href="#exec-os-1">OS Command Injection #1</a>
                        </li>
                        <li>
                          <a href="#exec-os-2">OS Command Injection #2</a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <b>Injection</b>
                      <ul>
                        <li>
                          <a href="#inj-xss">Stored Cross Site Scripting</a>
                        </li>
                        <li>
                          <a href="#inj-log">Log Injection // Log Spoofing</a>
                        </li>
                        <li>
                          <a href="#inj-html">HTML Injection</a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <b>Authorization Bypass</b>
                      <ul>
                        <li>
                          <a href="#bypassauthz-igql">GraphQL Interface Protection Bypass</a>
                        </li>
                        <li>
                          <a href="#bypassauthz-denylist">GraphQL Query Deny List Bypass</a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <b>Miscellaneous</b>
                      <ul>
                        <li>
                          <a href="#misc-weakpass">GraphQL Query Weak Password Protection</a>
                        </li>
                        <li>
                          <a href="#misc-filewrite">Arbitrary File Write // Path Traversal</a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>

            <div class="card-body">
              <h3 style="color:purple" id="dos-batch"><b>Overview</b></h3>
              <hr />
              <h4>Legend</h4>
              <ul>
                <li><i class="fa fa-newspaper"></i> - GraphQL Official Documentation / Blog Posts</li>
                <li><i class="fa fa-code"></i> - Code Snippet</li>
                <li><i class="fa fa-shield-alt"></i> - GraphQL Security Utility</li>
                <li><i class="fa fa-bug"></i> - Published Vulnerability (H1, CVE, etc.)</li>
              </ul>

              <p>
                <small style="color:grey"><i class="fa fa-info"></i> &nbsp; There may be more than one way to exploit any given vulnerability, the solutions demonstrated below aim to illustrate one way of achieving successful exploitation.</small>
                <br>
                <small style="color:grey"><i class="fa fa-info"></i> &nbsp; Some solutions include code snippets that are written in Python and use the requests library for HTTP requests.</small>
              </p>
              <br>
              {% for solution in solutions %}
                {% include solution %}
                <br>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<!-- /#page-content-wrapper -->
{% endblock %}

{% block scripts %}
  {% include 'partials/base_scripts.html' %}
  <script>
    function reveal(element) {
      var x = document.getElementById(element);
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "none";
      }
    }
  </script>
{% endblock %}